{
  "title": "Protocol",
  "type": "object",
  "properties": {
    "kind": {
      "type": "string",
      "enum": [
        "flows",
        "search",
        "search result",
        "history samples",
        "resave failed logs",
        "search samples",
        "search samples result"
      ]
    },
    "serverTime": {
      "type": "string"
    },
    "flows": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/protocolPackage.Flow"
      }
    },
    "search": {
      "$ref": "#/definitions/protocolPackage.Search"
    },
    "searchResult": {
      "$ref": "#/definitions/protocolPackage.SearchLogsResult"
    },
    "historySamples": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/protocolPackage.SampleFrame"
      }
    },
    "searchSamples": {
      "$ref": "#/definitions/protocolPackage.SearchSamples"
    },
    "searchSampleResult": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/protocolPackage.SampleFrame"
      }
    }
  },
  "required": [
    "kind"
  ],
  "minProperties": 2,
  "maxProperties": 3,
  "definitions": {
    "protocolPackage.Log": {
      "title": "Log",
      "type": "object",
      "properties": {
        "time": {
          "type": "string"
        },
        "content": {
          "type": "string"
        },
        "filepath": {
          "type": "string"
        },
        "hostname": {
          "type": "string"
        }
      },
      "required": [
        "time",
        "content",
        "filepath",
        "hostname"
      ]
    },
    "protocolPackage.Sample": {
      "title": "Sample",
      "type": "object",
      "properties": {
        "hostname": {
          "type": "string"
        },
        "port": {
          "type": "integer",
          "minimum": 0,
          "maximum": 4294967295
        },
        "values": {
          "type": "object",
          "additionalProperties": {
            "type": "integer",
            "minimum": 0,
            "maximum": 4294967295
          }
        }
      },
      "required": [
        "hostname",
        "port",
        "values"
      ]
    },
    "protocolPackage.SampleFrame": {
      "title": "SampleFrame",
      "type": "object",
      "properties": {
        "time": {
          "type": "string"
        },
        "samples": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/protocolPackage.Sample"
          }
        }
      },
      "required": [
        "time",
        "samples"
      ]
    },
    "protocolPackage.Flow": {
      "title": "Flow",
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "enum": [
            "log",
            "sample"
          ]
        },
        "log": {
          "$ref": "#/definitions/protocolPackage.Log"
        },
        "sample": {
          "$ref": "#/definitions/protocolPackage.Sample"
        }
      },
      "required": [
        "kind"
      ],
      "maxProperties": 2,
      "minProperties": 2
    },
    "protocolPackage.Search": {
      "title": "Search",
      "type": "object",
      "properties": {
        "q": {
          "type": "string"
        },
        "from": {
          "type": "integer",
          "minimum": 0,
          "maximum": 4294967295
        },
        "size": {
          "type": "integer",
          "minimum": 0,
          "maximum": 4294967295
        }
      },
      "required": [
        "q",
        "from",
        "size"
      ]
    },
    "protocolPackage.SearchLogsResult": {
      "title": "SearchLogsResult",
      "type": "object",
      "properties": {
        "total": {
          "type": "integer",
          "minimum": 0,
          "maximum": 4294967295
        },
        "logs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/protocolPackage.Log"
          }
        }
      },
      "required": [
        "total",
        "logs"
      ]
    },
    "protocolPackage.SearchSamples": {
      "title": "SearchSamples",
      "type": "object",
      "properties": {
        "from": {
          "type": "string"
        },
        "to": {
          "type": "string"
        }
      },
      "required": [
        "from",
        "to"
      ]
    }
  }
}